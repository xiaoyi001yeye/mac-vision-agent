# macOS视觉智能体 - Streamlit Web界面使用指南

## 🌐 Web界面概述

本项目现已提供基于Streamlit的Web界面，让您可以通过浏览器与macOS视觉智能体进行交互，无需命令行操作。

## 🚀 快速启动

### 方法1: 使用启动脚本（推荐）

```bash
# 在项目根目录下运行
python3 run_streamlit.py
```

### 方法2: 直接运行Streamlit

```bash
# 确保已安装streamlit
pip3 install streamlit

# 运行应用
python3 -m streamlit run streamlit_app.py --server.port 8501
```

## 🖥️ 界面功能介绍

### 主界面布局

#### 左侧边栏 - 服务控制面板

1. **🔧 服务控制**
   - **启动服务**: 初始化macOS操作服务
   - **停止服务**: 安全停止所有服务
   - **服务状态**: 实时显示服务运行状态

2. **⚡ 快捷操作**
   - 打开计算器
   - 打开文本编辑器
   - 打开Safari浏览器
   - 打开Finder
   - 打开系统偏好设置

3. **🗑️ 聊天管理**
   - 清空聊天历史

#### 主界面 - 对话区域

1. **💬 对话界面**
   - 显示用户与智能体的对话历史
   - 实时时间戳
   - 清晰的用户/智能体消息区分

2. **💭 输入区域**
   - 多行文本输入框
   - 发送按钮
   - 支持自然语言指令

## 📋 支持的命令

### 应用程序启动命令

#### 中文命令
- `打开计算器`
- `打开文本编辑器`
- `打开Safari浏览器`
- `打开Finder`
- `打开系统偏好设置`

#### 英文命令
- `Calculator`
- `TextEdit`
- `Safari`
- `Finder`
- `System Preferences`

#### 通用应用程序
- 任何已安装的macOS应用程序名称
- 例如：`Google Chrome`, `Visual Studio Code`, `Slack`

## 🔧 使用流程

### 1. 启动应用

```bash
# 运行启动脚本
python3 run_streamlit.py
```

等待看到以下信息：
```
🎉 Streamlit应用启动成功！
🌐 访问地址: http://localhost:8501
```

### 2. 打开浏览器

在浏览器中访问：`http://localhost:8501`

### 3. 启动服务

1. 在左侧边栏点击 **🚀 启动服务**
2. 等待服务初始化完成
3. 确认状态显示为 **✅ 服务已启动**

### 4. 开始使用

#### 方式1: 快捷操作
- 直接点击左侧边栏的快捷按钮
- 例如点击 "打开计算器"

#### 方式2: 文本输入
- 在底部输入框中输入指令
- 例如："打开Safari浏览器"
- 点击 **🚀 发送** 按钮

### 5. 查看结果

- 对话区域会显示执行结果
- ✅ 表示成功
- ❌ 表示失败，会显示错误信息

## 🛠️ 技术特性

### 界面特性
- **响应式设计**: 适配不同屏幕尺寸
- **实时状态**: 服务状态实时更新
- **聊天历史**: 完整的对话记录
- **错误处理**: 友好的错误提示

### 后端特性
- **服务管理**: 安全的服务启动/停止
- **命令解析**: 智能的自然语言理解
- **应用启动**: 支持所有macOS应用程序
- **日志记录**: 完整的操作日志

## 🔒 安全性

### 权限要求
1. **辅助功能权限**
   - 系统偏好设置 > 安全性与隐私 > 隐私 > 辅助功能
   - 添加终端或Python解释器

2. **自动化权限**
   - 系统偏好设置 > 安全性与隐私 > 隐私 > 自动化
   - 允许应用控制其他应用

### 安全特性
- **本地运行**: 所有操作在本地执行
- **权限验证**: 操作前进行安全检查
- **日志记录**: 所有操作都有详细日志

## 🐛 故障排除

### 常见问题

#### 1. 应用无法启动
```bash
# 检查Python版本
python3 --version

# 安装依赖
pip3 install -r requirements.txt

# 重新启动
python3 run_streamlit.py
```

#### 2. 服务启动失败
- 检查系统权限设置
- 确认没有其他程序占用相关资源
- 查看日志文件：`logs/error.log`

#### 3. 应用程序打开失败
- 确认应用程序名称正确
- 检查应用程序是否已安装
- 尝试使用英文应用名称

#### 4. 浏览器无法访问
- 确认端口8501未被占用
- 检查防火墙设置
- 尝试使用 `127.0.0.1:8501` 访问

### 调试模式

查看详细日志：
```bash
# 查看应用日志
tail -f logs/streamlit_app.log

# 查看错误日志
tail -f logs/error.log
```

## 📈 性能优化

### 建议配置
- **内存**: 建议4GB以上
- **网络**: 本地运行，无需网络连接
- **浏览器**: 推荐使用Chrome或Safari

### 优化技巧
1. **定期清理聊天历史**
2. **及时停止不需要的服务**
3. **关闭不必要的浏览器标签页**

## 🔮 扩展功能

### 自定义命令

可以在 `streamlit_app.py` 中的 `execute_simple_command` 方法中添加新的命令：

```python
elif "自定义命令" in command:
    # 添加自定义逻辑
    success = self.action_service.custom_action()
    return "✅ 自定义操作完成" if success else "❌ 自定义操作失败"
```

### 界面定制

修改 `streamlit_app.py` 中的界面元素：
- 更改主题颜色
- 添加新的快捷按钮
- 自定义页面布局

## 📞 技术支持

### 日志位置
- 应用日志：`logs/streamlit_app.log`
- 错误日志：`logs/error.log`
- 性能日志：`logs/performance.log`

### 配置文件
- 主配置：`src/config/settings.py`
- Streamlit配置：`~/.streamlit/config.toml`

---

## 🎉 使用示例

### 示例1: 打开工作应用

1. 启动Streamlit应用
2. 点击 "🚀 启动服务"
3. 在输入框中输入："打开Safari浏览器"
4. 点击发送
5. 查看执行结果

### 示例2: 批量操作

1. 点击 "打开计算器"
2. 等待执行完成
3. 点击 "打开文本编辑器"
4. 继续其他操作

### 示例3: 自定义应用

1. 在输入框中输入："Google Chrome"
2. 点击发送
3. 系统会尝试打开Chrome浏览器

---

**注意**: 使用前请确保已正确配置macOS权限，并且目标应用程序已安装。

🎊 享受使用macOS视觉智能体的Web界面！